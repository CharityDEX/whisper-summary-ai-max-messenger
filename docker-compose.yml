version: '3.8'

services:
  bot:
    build: .
    restart: always
    depends_on:
      - db
    environment:
      - DB_USER=${DB_USER}
      - DB_PASSWORD=${DB_PASSWORD}
      - DB_NAME=${DB_NAME}
      - DB_HOST=db
      - BOT_TOKEN=${BOT_TOKEN}
      - ADMIN_IDS=${ADMIN_IDS}
      - SESSION_NAME=${SESSION_NAME}
      - API_HASH=${API_HASH}
      - API_ID=${API_ID}
      - USER_BOT_ID=${USER_BOT_ID}
      - BOT_ID=${BOT_ID}
      - OPENAI_API_KEY=${OPENAI_API_KEY}
      - ANTHROPIC_API_KEY=${ANTHROPIC_API_KEY}
      - GROK_API_KEY=${GROK_API_KEY}
      - FAL_API_KEY=${FAL_API_KEY}
      - PAYMENT_PUBLIC_ID=${PAYMENT_PUBLIC_ID}
      - PAYMENT_API_SECRET=${PAYMENT_API_SECRET}
      - PAYMENT_URL=${PAYMENT_URL}
      - STRIPE_SECRET_KEY=${STRIPE_SECRET_KEY}
      - STRIPE_PUBLIC_KEY=${STRIPE_PUBLIC_KEY}
      - STRIPE_WEBHOOK_SECRET=${STRIPE_WEBHOOK_SECRET}
      - STRIPE_SUCCESS_URL=${STRIPE_SUCCESS_URL}
      - STRIPE_CANCEL_URL=${STRIPE_CANCEL_URL}
      - STRIPE_WEEKLY_PRICE_ID=${STRIPE_WEEKLY_PRICE_ID}
      - STRIPE_MONTHLY_PRICE_ID=${STRIPE_MONTHLY_PRICE_ID}
      - STRIPE_ANNUAL_PRICE_ID=${STRIPE_ANNUAL_PRICE_ID}

  max-bot:
    build:
      context: .
      args:
        ENTRYPOINT_SCRIPT: max_main.py
    restart: always
    depends_on:
      - db
    environment:
      - DB_USER=${DB_USER}
      - DB_PASSWORD=${DB_PASSWORD}
      - DB_NAME=${DB_NAME}
      - DB_HOST=db
      - MAX_BOT_TOKEN=${MAX_BOT_TOKEN}
      - MAX_ADMIN_IDS=${MAX_ADMIN_IDS}
      - MAX_BOT_DEFAULT_LANG=${MAX_BOT_DEFAULT_LANG}
      - MAX_LOG_CHAT_ID=${MAX_LOG_CHAT_ID}
      - BOT_TOKEN=${BOT_TOKEN}
      - BOT_ID=${BOT_ID}
      - BOT_NAME=${BOT_NAME}
      - BOT_DEFAULT_LANG=${BOT_DEFAULT_LANG}
      - BOT_URL=${BOT_URL}
      - ADMIN_IDS=${ADMIN_IDS}
      - ADMIN_API_KEY=${ADMIN_API_KEY}
      - PROXY=${PROXY}
      - SESSION_NAME=${SESSION_NAME}
      - API_HASH=${API_HASH}
      - API_ID=${API_ID}
      - USER_BOT_ID=${USER_BOT_ID}
      - OPENAI_API_KEY=${OPENAI_API_KEY}
      - ANTHROPIC_API_KEY=${ANTHROPIC_API_KEY}
      - GROK_API_KEY=${GROK_API_KEY}
      - FAL_API_KEY=${FAL_API_KEY}
      - ELEVATEAI_API_KEY=${ELEVATEAI_API_KEY}
      - ASSEMBLYAI_API_KEY=${ASSEMBLYAI_API_KEY}
      - FIREWORKS_API_KEY=${FIREWORKS_API_KEY}
      - PAYMENT_PUBLIC_ID=${PAYMENT_PUBLIC_ID}
      - PAYMENT_API_SECRET=${PAYMENT_API_SECRET}
      - PAYMENT_URL=${PAYMENT_URL}
      - STRIPE_SECRET_KEY=${STRIPE_SECRET_KEY}
      - STRIPE_PUBLIC_KEY=${STRIPE_PUBLIC_KEY}
      - STRIPE_WEBHOOK_SECRET=${STRIPE_WEBHOOK_SECRET}
      - STRIPE_SUCCESS_URL=${STRIPE_SUCCESS_URL}
      - STRIPE_CANCEL_URL=${STRIPE_CANCEL_URL}
      - STRIPE_WEEKLY_PRICE_ID=${STRIPE_WEEKLY_PRICE_ID}
      - STRIPE_MONTHLY_PRICE_ID=${STRIPE_MONTHLY_PRICE_ID}
      - STRIPE_ANNUAL_PRICE_ID=${STRIPE_ANNUAL_PRICE_ID}
      - STRIPE_SEMIANNUAL_PRICE_ID=${STRIPE_SEMIANNUAL_PRICE_ID}
      - STRIPE_COUPON_DISCOUNTED_NOTIFICATION_ID=${STRIPE_COUPON_DISCOUNTED_NOTIFICATION_ID}
      - PRIVATE_STT_API_URL=${PRIVATE_STT_API_URL}
      - PRIVATE_STT_API_KEY=${PRIVATE_STT_API_KEY}
      - GOOGLE_SERVICE_ACCOUNT_FILE=${GOOGLE_SERVICE_ACCOUNT_FILE}
      - GOOGLE_CREDENTIALS_FILE=${GOOGLE_CREDENTIALS_FILE}
      - RAPIDAPI_KEY=${RAPIDAPI_KEY}
      - FEDOR_API_USERNAME=${FEDOR_API_USERNAME}
      - FEDOR_API_PASSWORD=${FEDOR_API_PASSWORD}
      - CLOUDPAYMENTS_WEEKLY_PRICE=${CLOUDPAYMENTS_WEEKLY_PRICE}
      - CLOUDPAYMENTS_MONTHLY_PRICE=${CLOUDPAYMENTS_MONTHLY_PRICE}
      - CLOUDPAYMENTS_SEMIANNUAL_PRICE=${CLOUDPAYMENTS_SEMIANNUAL_PRICE}
      - CLOUDPAYMENTS_DISCOUNTED_NOTIFICATION_PRICE=${CLOUDPAYMENTS_DISCOUNTED_NOTIFICATION_PRICE}
      - STRIPE_WEEKLY_PRICE=${STRIPE_WEEKLY_PRICE}
      - STRIPE_MONTHLY_PRICE=${STRIPE_MONTHLY_PRICE}
      - STRIPE_SEMIANNUAL_PRICE=${STRIPE_SEMIANNUAL_PRICE}
      - STRIPE_DISCOUNTED_NOTIFICATION_PRICE=${STRIPE_DISCOUNTED_NOTIFICATION_PRICE}

  db:
    image: postgres:15
    restart: always
    environment:
      - POSTGRES_USER=${DB_USER}
      - POSTGRES_PASSWORD=${DB_PASSWORD}
      - POSTGRES_DB=${DB_NAME}
    volumes:
      - postgres_data:/var/lib/postgresql/data

volumes:
  postgres_data:
